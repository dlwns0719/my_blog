---
title: Part 2 — 프롬프트 구조와 기능 탐구
jupyter: python3
categories:
  - AI
  - LangChain
  - Prompt_Engineering
---
# 프롬프트 설계 원칙

## 4대 원칙

1. **범용성**: 다양한 상황과 과제에서 안정적으로 동작해야 한다.  
2. **목적 지향성**: 사용자 목적을 세분화해 달성할 수 있도록 설계한다. 
인실리코 사용자의 니즈에 맞게 설계를 할 수 있어야 하고, 그에 따른 결과를 내 줄수 있어야 한다.
3. **일관성**: 모델이 달라지거나 여러 번 실행해도 결과 품질이 크게 흔들리지 않아야 한다.
4. **경제성**: 토큰 수와 호출 횟수를 줄여 비용을 절감한다.

## Scaffolding Prompting
- 비계식(Scaffolding) 설계
* 인간의 학습 이론(ZPD)에 착안한 단계적 설계 방식
- 쉬운 것에서 어려운 것으로 점진적으로 난이도를 올린다.
- 단어 → 문장 → 문단처럼 단계별 학습을 적용한다. 
- 프롬프트도 같은 방식으로 설계하면 품질과 재현성이 올라간다. 
* Understand → Ideation → Analysis → Apply → Evaluate → Generalize
- 문제(요구사항)를 정확히 이해한다.
- 이해를 바탕으로 다양한 프롬프트 아이디어를 만든다.
- 실험과 분석을 통해 좋은 프롬프트를 선별한다.
- 실제 환경에 적용하고 평가한다.
- 일반화 가능한 결과를 얻으면 배포한다.
* 단계적 사고를 유도하여 안정적인 개선을 이끈다.

## 핵심 5 Tips

### Tip1. 최신 모델 사용
- 최신 모델을 우선 고려한다(GPT-4/5 등).
- 최신 모델은 프롬프트가 다소 엉성해도 양호한 결과를 내는 경향이 있다.
- 다만, 비용·제약을 고려해 이전 세대 모델(예: GPT‑3.5)을 잘 튜닝해 목표 품질에 도달하는 전략도 유효하다.

### Tip2. 명확한 동사로 지시
어떤 표현이 더 구체적이고 명확한지 검토한다.  
모호한 표현 대신 명령형 동사를 사용하면 모델이 의도를 오해할 가능성이 줄어든다.  
예: “분석해, 정리해, 요약해, 작성해”처럼 과업을 바로 수행할 수 있는 동사를 쓴다.

### Tip3. 프롬프트를 구조화하자
구조화는 요소를 구분하고 섹션을 나눠 LLM이 읽고 해석하기 쉬운 형태를 만드는 일이다.  
핵심 방법은 **Markdown**, **코드 프롬프트**, **XML 태그**다.  
구조화를 적용하면 작업 목적·규칙·입력 데이터·출력 형식을 혼동 없이 처리할 수 있다.

1. Markdown 기호 사용하기 (Headers, Lists, Emphasis)

Markdown은 LLM이 가장 잘 해석하는 구조적 문법 중 하나이다.  
섹션을 명확히 나누고, 각 부분을 시각적으로 구분해줌으로써  
모델의 오류를 줄이고 반복 작업 시 유지보수성이 높아진다.

1.1 헤더(Headers) 활용
헤더는 프롬프트의 큰 구성을 나누는 데 사용한다.  
샾(#)의 개수로 제목의 깊이를 표현해 계층을 드러낸다. 

```markdown
# 역할(Role)
너는 스포츠 기사 분석 엔진이다.

## 작업(Task)
아래 텍스트에서 장소(도시, 국가, 축구 클럽)를 모두 추출해라.

## 출력 형식(Format)
- "장소: A, B, C" 형태의 한 줄 출력
- 설명 금지

## 텍스트(Text)
{{TEXT}}
```

1.2 목록(Lists) 활용
하이픈 또는 번호 목록을 사용해 절차·규칙·조건을 단계별로 제시한다.  
순차 수행이 필요한 지시에는 번호 목록이 특히 효과적이다.

```markdown
다음 규칙을 따라 작업을 수행해라.
1. 사람 이름은 제외한다.
2. 축구 클럽은 장소로 포함한다.
3. 결과는 쉼표로 구분한다.
4. 설명 문장은 쓰지 않는다.
```

1.3 강조(Emphasis) 사용

중요 조건은 굵게/기울임으로 강조해 우선순위를 명확히 한다.  
시각적 강조 자체보다 “다른 요소임을 구분”시키는 데 의미가 있다.

```markdown
- 반드시 **한국어**로 작성하라.
- 출력은 **한 줄**로만 작성한다.
- *설명 문장은 포함하지 않는다.*
```

2. 코드 프롬프트(Code Prompting)

더 높은 정밀도의 구조화를 원할 때는 코드 프롬프트가 유용하다.  
파이썬 등으로 “해야 할 작업”을 명시적으로 표현하면 애매함이 줄고,  
LLM이 구조적으로 이해해 할루시네이션이 감소한다.

```python
# 역할 정의
role = "정보 추출 엔진"

# 작업 정의
task = "텍스트에서 '장소명'을 추출해 정렬된 리스트로 반환"

# 출력 형식 정의
output = {
    "places": ["string"]
}
```

코드 방식의 장점:

* 논리 구조가 명확하게 표현됨
* 조건과 출력 형식이 혼동되지 않음
* 정형화된 포맷을 자주 재사용 가능

3. XML 태그 기반 구조화 (Claude 최적화)

엔트로픽 프롬팅 쿡북에 소개된 방식으로,  
문장 내 구역을 명확히 나누고 반복 작업에서 편집이 쉬우며,  
모델의 처리·파싱 안정성을 높인다.  
XML 태그는 텍스트 내 특정 영역을 분명히 구분해
Claude뿐 아니라 대부분의 LLM에서 **구조적 파싱**을 돕는다.

또한 템플릿화가 쉬워 재사용성이 높다. 

- 태그로 영역 지정

```text
<email>
Show up at 6AM because I say so.
</email>

Make this email more polite.
```

LLM은 `<email>...</email>` 내부 텍스트만 변환하면 된다는 점을 명확히 이해한다.

- 데이터 템플릿 예시

```text
<animal>{{ANIMAL}}</animal>
```

입력 값만 바꾸어 동일한 템플릿을 반복 적용할 수 있다.

예:

```text
<animal>Cow</animal>
<animal>Dog</animal>
<animal>Seal</animal>
```

장점:

* 구역별 의미가 명확하다.
* 반복 작업에서 수정이 쉽고 안정적이다.
* 모델이 태그 단위로 파싱하므로 오류가 줄어든다.

4. 구조화 기법이 필요한 이유

* 명령어·입력·출력 형식을 명확히 구분해 **해석 오류를 줄인다.**
* 규칙을 시각적으로 구분해 **일관성과 재현성**을 높인다.
* 재사용 가능한 템플릿을 통해 **제작 비용과 시간을 절감**한다.


### Tip4. 단문 중심의 간결한 문장을 쓰자.

* 한국어는 짧고 명확하게 작성한다.
* 톤·형식·분량을 구체적으로 지시한다.
```text
- 나쁜 예
5월의 봄을 주제로 시를 써주고 짧게
작성해줘 봄의 느낌을 살려봐.
결과: 오월의 푸른 하늘 아래
새싹이 희망을 노래하네.
아침 이슬에 빛나는 꽃들,
봄바람 따라 춤추는 나비.
모든 거리는 축제가 되어.

- 좋은 예
너는 시인이야. 한국의 계절, 봄을 상상해봐.
5월이야. 다양한 꽃이 여기저기 폈어.
그 분위기에 어울리는 짧은 시를 5줄 이내로
작성해줘. 한글 고유의 멋이 시에 드러나면 좋겠어.
결과: 봄바람, 너른 들녘을 스치며
꽃잎들 춤추듯 흩날리네
산들산들 부는 바람에
눈부신 햇살 아래
은은한 꽃 향기에 취하노라
```

### Tip5. 하지 말 것(X) → 할 것(O)

* 부정 지시보다 긍정적 행동 지시가 더 안정적이다.  
모델이 추측하지 않도록 구체적인 지시를 단문으로 제공한다.
```text
- 나쁜 예
다음은 에이전트와 고객의 대화이다.
고객에게 아이디와 비밀번호를 묻지
않는다. 반복하지 않는다.

- 좋은 예
다음은 에이전트와 고객과의 대화내용이다.
챗봇은 고객의 대화에서 드러난 문제를 진단하고 해결책을
제시해야 한다. 사용자 아이디와 비밀번호같은 개인정보를
묻지 않는 대신,
사용자가 www.samplewebsite.com/help/faq에서 관련
사항을 찾도록 안내해라.
```

## 프롬프트 제작에 100% 절대적인 것은 없다. 
- 아래 원칙을 상황에 맞게 적용하되, 맹목적으로 고정하지 말자.
- 반드시 금지해야 할 조건은 명확히 규정한다.
- LLM이 임의로 추론하지 않도록 가능한 한 구체적으로 지시한다.
- 긍정문을 기본으로 하되, 절대 금지 항목은 필요 시 이중 부정으로 강조한다.


# LLM의 한계와 프롬프트 엔지니어링 필요성

## LLM 한계

* 할루시네이션: 모르는 질문에 대해 추론으로 잘못된 정보를 생성한다.
* 편향성: 고정관념이나 편견이 반영될 수 있다.
* 근거 없는 출처 생성: 인용·출처가 사실과 다를 수 있다.
* 수학 및 추론 한계: 간단한 수학·상식 문제에서도 오류가 날 수 있다.
* Prompt Injection(프롬프트 해킹): 악의적 지시로 안전장치를 우회/조작할 수 있다.

## 프롬프트 엔지니어링이 필요한 이유
- 위 한계를 완벽히 제거할 수는 없지만, 프롬프트 엔지니어링으로 상당 부분 보완·완화할 수 있다. 
* 정확성 향상
* 오류·편향 감소
* 모델 행동 제어
* 사용자 경험 개선
* 비용 절감